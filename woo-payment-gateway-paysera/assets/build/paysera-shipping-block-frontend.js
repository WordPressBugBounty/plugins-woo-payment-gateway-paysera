!function(){var e,t={685:function(e,t,a){"use strict";var n=window.wc.blocksCheckout,o=window.wp.element,r=window.wp.i18n,i=window.wp.apiFetch,s=a.n(i),l=window.wp.data,c=window.wp.components,p=a(184),u=a.n(p);const d=e=>{let{label:t,value:a,options:r,onChange:i,errorMessage:s}=e;const l=(0,o.useRef)(null);return(0,o.createElement)("div",{ref:l,className:u()("wc-block-components-combobox","paysera-combobox",{"is-active":a})},(0,o.createElement)(c.ComboboxControl,{className:"wc-block-components-combobox-control",label:t,value:a,options:r,onChange:e=>{var t;const a=null!==(t=l.current?.getElementsByTagName("input"))&&void 0!==t?t:[];a.length>0&&a[0].blur(),i(e)},allowReset:!1,autoComplete:"off"}),s&&(0,o.createElement)(n.ValidationInputError,{errorMessage:s}))},y=()=>{const e=window?.wcPaysera?.base||"";return{countries:e+"/delivery/countries",cities:e+"/delivery/terminal-cities",locations:e+"/delivery/terminal-locations",locations_set:e+"/delivery/set-terminal-location",validation:e+"/delivery/validation"}},m=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),f="paysera-shipping-block-validation-terminal-country-error",g="paysera-shipping-block-validation-terminal-city-error",h="paysera-shipping-block-validation-terminal-location-error",v=e=>Object.keys(e).map((t=>({label:e[t],value:t})));var b=JSON.parse('{"apiVersion":2,"name":"paysera/shipping-methods","version":"1.0.0","title":"Paysera Shipping Methods","category":"woocommerce","description":"Add Paysera terminal selection to shipping methods.","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-shipping-methods-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}},"text":{"type":"string","source":"html","selector":".wp-block-paysera-shipping","default":""}},"textdomain":"paysera"}');(0,n.registerCheckoutBlock)({metadata:b,component:e=>{let{checkoutExtensionData:t,extensions:a,...n}=e;const{cart:i}=n,{shippingRates:c,shippingAddress:p}=i,u=(0,l.useSelect)((e=>e("wc/store/validation").getValidationError(f))),b=(0,l.useSelect)((e=>e("wc/store/validation").getValidationError(g))),w=(0,l.useSelect)((e=>e("wc/store/validation").getValidationError(h))),_=["paysera_delivery_lp_terminals","paysera_delivery_omniva_terminals","paysera_delivery_venipak_terminals"],k=(c?.[0]?.shipping_rates||[]).some((e=>{const t=!0===e?.selected,a=_.some((t=>e?.rate_id?.includes(t)));return t&&a}))||!1,[E,S]=(0,o.useState)(!1),[C,O]=(0,o.useState)([]),[x,P]=(0,o.useState)([]),[T,L]=(0,o.useState)([]),j=window?.wcSettings?.paysera_data,D=(c?.[0]?.shipping_rates||[]).find((e=>!0===e.selected))?.rate_id,[M,N]=(0,o.useState)(void 0!==D&&j?.country||"default"),[V,A]=(0,o.useState)(void 0!==D&&j?.city||"default"),[F,R]=(0,o.useState)(void 0!==D&&j?.location||"default"),$=e=>RegExp("paysera_delivery_.*_terminals").test(e);(e=>{let{shippingLogos:t}=e;if(0===t.length)return;const a=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(a);const n=e=>{a.innerHTML=`${e}`;for(const e of Object.keys(t))a.innerHTML+=`\n        .wc-block-components-radio-control__label[id*="${e}"]::before {\n          background-image: url('${t[e].url}');\n        }\n      `};(0,o.useEffect)((()=>{setTimeout((()=>{n(""),(()=>{const e=document.querySelector(".wc-block-components-shipping-rates-control__package");if(null===e)return;if(e.querySelectorAll(".wc-block-components-radio-control__option").length>0)return;const a=e.querySelector(".wc-block-components-radio-control__label");if(null!==a)for(const e of Object.keys(t))a.innerText.startsWith(t[e].name)&&n(`\n        .wc-block-components-shipping-rates-control__package .wc-block-components-radio-control__label::before {\n          content: "";\n          display: block;\n          width: 100px;\n          padding-top: 10%;\n          background: url('${t[e].url}') no-repeat center / contain;\n        }\n      `)})()}))}),[t])})({shippingLogos:j?.shippingLogos}),(e=>{let{checkoutExtensionData:t,isPayseraTerminalSelected:a,terminalCountry:n,terminalCity:i,terminalLocation:s}=e;const{setExtensionData:c}=t,{setValidationErrors:p,clearValidationError:u}=(0,l.useDispatch)("wc/store/validation"),d={country:n,city:i,location:s},y={country:{id:f,message:(0,r.__)("Please select paysera terminal country.","paysera")},city:{id:g,message:(0,r.__)(" Please select paysera terminal city.","paysera")},location:{id:h,message:(0,r.__)(" Please select paysera terminal location.","paysera")}};(0,o.useEffect)((()=>{for(const[e,t]of Object.entries(d)){const n=a&&"default"===t?y[e].message:"";n?p({[y[e].id]:{message:n,hidden:!1}}):u(y[e].id)}}),[a,n,i,s,u]),(0,o.useEffect)((()=>{c("paysera","payseraDeliveryCountry",a?n:"")}),[c,n,a]),(0,o.useEffect)((()=>{c("paysera","payseraDeliveryCity",a?i:"")}),[c,i]),(0,o.useEffect)((()=>{c("paysera","payseraDeliveryLocation",a?s:"")}),[c,s])})({checkoutExtensionData:t,isPayseraTerminalSelected:k,terminalCountry:M,terminalCity:V,terminalLocation:F,terminalCountries:C,terminalCities:x,terminalLocations:T}),(0,o.useEffect)((()=>(k?document.body.classList.add("paysera-shipping-terminal-selected"):document.body.classList.remove("paysera-shipping-terminal-selected"),()=>{document.body.classList.remove("paysera-shipping-terminal-selected")})),[k]),(0,o.useEffect)((()=>{"string"==typeof D&&$(D)&&(S(!0),s()({path:window?.wcPaysera?.base+"/delivery/terminal-countries",method:"POST",data:{shipping_method:D}}).then((e=>{O(v(e))})).catch((e=>{console.error(e)})).finally((()=>{S(!1)})))}),[D]),(0,o.useEffect)((()=>{A("default"),R("default"),N(p?.country)}),[p?.country]),(0,o.useEffect)((()=>{const e=x.find((e=>m(e.value.toLowerCase())===m(p?.city?.toLowerCase())));e&&A(e.value)}),[p?.city,x]),(0,o.useEffect)((()=>{"string"==typeof M&&"default"!==M&&"string"==typeof D&&$(D)&&q(M,D)}),[M,D]),(0,o.useEffect)((()=>{"string"==typeof M&&"default"!==M&&"string"==typeof V&&"default"!==V&&"string"==typeof D&&$(D)&&B(M,V,D)}),[V,D]);const q=async(e,t)=>{S(!0);const a=await(async(e,t)=>await s()({path:y().cities,method:"POST",data:{country:e,shipping_method:t}}).then((e=>e)).catch((e=>{console.error(e)})))(e,t)||[];P(v(a)),A("default"),S(!1)},B=async(e,t,a)=>{S(!0);const n=await(async(e,t,a)=>await s()({path:y().locations,method:"POST",data:{country:e,city:t,shipping_method:a}}).then((e=>e)).catch((e=>{console.error(e)})))(e,t,a)||[];L(v(n)),R("default"),S(!1)};return(0,o.createElement)(o.Fragment,null,k&&(0,o.createElement)("div",{className:"paysera-delivery-terminals",style:{opacity:E?.5:1,pointerEvents:E?"none":"auto"}},(0,o.createElement)(d,{label:(0,r.__)("Terminal country","paysera"),value:M,options:C,onChange:e=>{N(e)},errorMessage:u?.message}),"default"!==M&&""!==M&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)(d,{label:(0,r.__)("Terminal city","paysera"),value:V,options:x,onChange:e=>{A(e)},errorMessage:b?.message}),"default"!==V&&""!==V&&(0,o.createElement)(d,{label:(0,r.__)("Terminal location","paysera"),value:F,options:T,onChange:async e=>{R(e),await(async e=>await s()({path:y().locations_set,method:"POST",data:{terminal:e}}).then((e=>e)).catch((e=>{console.error(e)})))(e)},errorMessage:w?.message}))))}})},184:function(e,t){var a;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var r=typeof a;if("string"===r||"number"===r)e.push(a);else if(Array.isArray(a)){if(a.length){var i=o.apply(null,a);i&&e.push(i)}}else if("object"===r){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){e.push(a.toString());continue}for(var s in a)n.call(a,s)&&a[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(a=function(){return o}.apply(t,[]))||(e.exports=a)}()}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var r=a[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,e=[],n.O=function(t,a,o,r){if(!a){var i=1/0;for(p=0;p<e.length;p++){a=e[p][0],o=e[p][1],r=e[p][2];for(var s=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(p--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var p=e.length;p>0&&e[p-1][2]>r;p--)e[p]=e[p-1];e[p]=[a,o,r]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={97:0,431:0,793:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,i=a[0],s=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)var p=l(n)}for(t&&t(a);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(p)},a=self.webpackChunkwoo_payment_gateway_paysera=self.webpackChunkwoo_payment_gateway_paysera||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var o=n.O(void 0,[431,793],(function(){return n(685)}));o=n.O(o)}();